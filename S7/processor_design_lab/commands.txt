use python3.12

sudo apt update
sudo apt install -y \
    build-essential git m4 scons zlib1g zlib1g-dev \
    libprotobuf-dev protobuf-compiler libprotoc-dev \
    libgoogle-perftools-dev python3-dev python3-pip \
    python-is-python3 libboost-all-dev pkg-config \
    qemu-system-x86 qemu-kvm libvirt-daemon-system \
    docker.io virtualenv

Cloning gem5
git clone https://github.com/gem5/gem5
git clone https://github.com/gem5/gem5-resources
cd gem5-resources
cd src/spec-2006    

Building m5
cd util/m5
scons build/x86/out/m5

Copy the ISO file
mkdir -p ~/gem5-resources/src/spec-2006/disk-image/spec-2006/
cp /path/to/cpu2006-1.2.iso ~/gem5-resources/src/spec-2006/disk-image/spec-2006/

building x86 gem5
cd ~/gem5   
scons build/X86/gem5.opt -j $(nproc)

Install Packer
cd ~/gem5-resources/src/spec-2006/disk-image/
wget https://releases.hashicorp.com/packer/1.6.6/packer_1.6.6_linux_amd64.zip
unzip packer_1.6.6_linux_amd64.zip && rm packer_1.6.6_linux_amd64.zip

for QEMU
sudo usermod -a -G kvm $(whoami)
newgrp kvm  # Refresh group permissions

Build Image
./packer validate spec-2006/spec-2006.json  
./packer build spec-2006/spec-2006.json

(OR)

./build.sh

Run the Simulator
./gem5/build/X86/gem5.opt /home/iamthope/processor_des_lab/another_gem5/gem5/configs/example/gem5_library/x86-spec-cpu2006-benchmarks.py --image /home/iamthope/processor_des_lab/another_gem5/disk-image/spec-2006/spec-2006-image/spec-2006 --partition 1 --benchmark 403.gcc --size ref

sudo sh -c 'echo 1 > /proc/sys/kernel/perf_event_paranoid'